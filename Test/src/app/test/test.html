<div class = "container mt 4">
  <h3 class="text-center mb-4">Posts: ({{posts.length}})</h3>

  <ng-container *ngFor="let p of posts; let i = index;">
    <div class = "card-body">
      <p class="mb-2">
        by <strong>{{ p.user }}</strong> at {{ p.timestamp | date:'medium'}}
      </p>
      <hr>

      <p *ngIf="!p.editing">{{p.comment}}</p>

      <textarea *ngIf="p.editing" class="form-control mb-3" rows="3"  [(ngModel)]="p.comment"></textarea>


      <div class="d-flex justify-content-start gap-2">
        <button *ngIf="p.editing" class="btn btn-outline-secondary btn-sm" (click)="cancelEdit(p)">Cancel</button>
        <button class="btn btn-sm btn-outline-danger" (click)="deletePost(i)">Delete</button>
        <button *ngIf="!p.editing" class="btn btn-sm btn-outline-primary" (click)="editPost(p)">Edit</button>
        <button *ngIf="p.editing" class="btn btn-sm btn-outline-success" (click)="savePost(p)">Done editing</button>
      </div>
      <br>
    </div>
  </ng-container>
</div>

<h3 class="text-center mb-4">Add Comment</h3>
<div class="d-flex justify-content-center">
  <button class="btn btn-outline-success mb-3 px-3 py-1" (click)="toggleAdd()">
    Create a new comment
  </button>
</div>

<div class="d-flex justify-content-center" *ngIf="adding">
  <div class="card p-3 shadow-sm w-100" style="max-width: 450px;">

    <label class="fw-bold mb-1">User:</label>
    <input class="form-control mb-3" [(ngModel)]="newUser">

    <label class="fw-bold mb-1">Comment:</label>
    <textarea class="form-control mb-3" rows="3" [(ngModel)]="newComment"></textarea>

    <div class="d-flex gap-3 justify-content-center">
      <button class="btn btn-danger px-4 py-1 text-white" (click)="toggleAdd()">
        Cancel
      </button>

      <button class="btn px-4 py-1 text-white"
              [class.btn-success]="newComment.length > 0"
              [class.btn-danger]="newComment.length === 0"
              (click)="addPost()">
        Send
      </button>

    </div>


  </div>
</div>
